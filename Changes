import React from 'react';
import styled from 'styled-components';
import { AlternateCheckMark, ToolTip } from '@vds/components';

const StepperContainer = styled.div`
  position: relative;
  margin: 20px 0;
`;

const StepLine = styled.div`
  position: absolute;
  top: 20px;
  left: 0;
  right: 0;
  height: 2px;
  background-color: black;
  z-index: 1;
`;

const StepWrapper = styled.div`
  display: flex;
  position: relative;
  justify-content: space-between;
  z-index: 2;
`;

const StepGroup = styled.div`
  display: flex;
  align-items: center;
  background-color: ${({ active }) => (active ? '#e5f3ff' : 'transparent')};
  border-radius: 8px;
  padding: 10px 20px;
`;

const TooltipWrapper = styled.div`
  margin: 0 10px;
  display: flex;
  align-items: center;
`;

function Stepper({ steps }) {
  // Logic to highlight the first group as active
  const activeStepIndex = steps.findIndex(step => step.inProgress);

  return (
    <StepperContainer>
      <StepLine />
      <StepWrapper>
        {steps.map((step, index) => {
          const { completed, inProgress, children } = step;
          const isActiveGroup = index === activeStepIndex;

          return (
            <StepGroup key={index} active={isActiveGroup}>
              <AlternateCheckMark completed={completed} inProgress={inProgress} />
              <TooltipWrapper>
                <ToolTip content={step.name} />
              </TooltipWrapper>
              {children?.map((child, childIndex) => (
                <React.Fragment key={childIndex}>
                  <AlternateCheckMark
                    completed={child.completed}
                    inProgress={child.inProgress}
                  />
                  <TooltipWrapper>
                    <ToolTip content={child.name} />
                  </TooltipWrapper>
                </React.Fragment>
              ))}
            </StepGroup>
          );
        })}
      </StepWrapper>
    </StepperContainer>
  );
}

export default Stepper;