import React, { useEffect, useState } from "react";
import ReactFlow, { Handle } from "react-flow-renderer";

const NewKibanaDisplay = () => {
  const [apiUris, setApiUris] = useState([]);

  useEffect(() => {
    fetch("YOUR_JSON_URL_HERE") // Replace with your actual URL
      .then((response) => response.json())
      .then((data) => {
        const apiNodes = data.data.map((item, index) => ({
          id: `node-${index}`,
          data: { label: item.api_Uri },
          position: { x: 100, y: index * 100 }, // Arrange in vertical flow
        }));

        const edges = apiNodes.slice(1).map((node, index) => ({
          id: `edge-${index}`,
          source: `node-${index}`,
          target: `node-${index + 1}`,
        }));

        setApiUris({ nodes: apiNodes, edges });
      })
      .catch((error) => console.error("Error fetching data:", error));
  }, []);

  return (
    <div style={{ height: "500px", width: "100%" }}>
      <ReactFlow nodes={apiUris.nodes} edges={apiUris.edges} />
    </div>
  );
};

export default NewKibanaDisplay;